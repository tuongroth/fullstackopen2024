// Function to handle form submission for adding a new person
const addPerson = (event) => {
  event.preventDefault();

  // Check if the person already exists in the phonebook
  const existingPerson = persons.find(person => person.name === newName);

  // If person already exists, confirm update
  if (existingPerson) {
    if (window.confirm(`${newName} is already added to the phonebook. Replace the old number with a new one?`)) {
      const changedPerson = { ...existingPerson, number: newNumber };

      personsService
        .update(existingPerson.id, changedPerson)
        .then(returnedPerson => {
          setPersons(persons.map(person =>
            person.id !== existingPerson.id ? person : returnedPerson
          ));
          setNewName('');
          setNewNumber('');
        })
        .catch(error => {
          console.error('Error updating person:', error);
        });
    }
  } else {
    // If person does not exist, create a new person
    const newPerson = {
      name: newName,
      number: newNumber,
    };

    personsService
      .create(newPerson)
      .then(returnedPerson => {
        setPersons(persons.concat(returnedPerson));
        setNewName('');
        setNewNumber('');
      })
      .catch(error => {
        console.error('Error adding person:', error);
      });
  }
};
