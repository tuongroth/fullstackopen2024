import React from 'react';
import { useQuery, useMutation, QueryClient, QueryClientProvider } from 'react-query';
import axios from 'axios';

// Create a QueryClient instance
const queryClient = new QueryClient();

// Fetch function for anecdotes
const fetchAnecdotes = async () => {
  const response = await axios.get('http://localhost:3001/anecdotes');
  return response.data;
};

// Component
const App = () => {
  const { data: anecdotes, error, isLoading } = useQuery('anecdotes', fetchAnecdotes);

  if (isLoading) return <div>Loading...</div>;
  if (error) return <div>An error occurred: {error.message}</div>;

  return (
    <div>
      <h1>Anecdotes</h1>
      <ul>
        {anecdotes.map((anecdote: any) => (
          <li key={anecdote.id}>{anecdote.content}</li>
        ))}
      </ul>
    </div>
  );
};

// Root component with QueryClientProvider
const Root = () => (
  <QueryClientProvider client={queryClient}>
    <App />
  </QueryClientProvider>
);

export default Root;
